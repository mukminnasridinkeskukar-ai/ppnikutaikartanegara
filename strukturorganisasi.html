<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Pengurus</title>

<!-- FONT -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
/* ================= BASE ================= */
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Poppins',Segoe UI,Arial,sans-serif;
  background:#f8fafc;
}

/* ================= WRAPPER ================= */
.profile-wrapper{
  width:100%;
  padding:16px;
}

/* ================= GRID CARD ================= */
.profile-list{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:24px;
}

/* ================= CARD ================= */
.profile-card{
  background:#fff;
  border-radius:20px;
  padding:22px 18px;
  box-shadow:0 16px 36px rgba(0,0,0,.15);
  cursor:pointer;
  text-align:center;
  transition:.35s;
}
.profile-card:hover{
  transform:translateY(-6px);
  box-shadow:0 28px 56px rgba(30,64,175,.28);
}

/* FOTO CARD */
.profile-photo{
  width:120px;
  height:120px;
  margin:0 auto 14px;
  border-radius:50%;
  overflow:hidden;
  background:#e5e7eb;
}
.profile-photo img{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* TEXT CARD */
.profile-name{
  font-weight:600;
  font-size:15px;
}
.profile-role{
  font-size:14px;
  color:#1e40af;
  margin-top:6px;
}
.profile-nira{
  font-size:13px;
  color:#64748b;
  margin-top:6px;
}

/* ================= FULLSCREEN MODAL ================= */
.profile-modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(10,15,25,.94);
  z-index:99999;
}

/* MODAL CONTENT */
.profile-modal-box{
  display:flex;
  max-width:1200px;
  width:96%;
  height:90vh;
  margin:5vh auto;
  background:#fff;
  border-radius:30px;
  overflow:hidden;
}

/* FOTO KIRI */
.profile-photo-large{
  width:420px;
  background:#0f172a;
  display:flex;
  align-items:center;
  justify-content:center;
}
.profile-photo-large img{
  max-width:100%;
  max-height:100%;
  object-fit:contain;
}

/* DATA KANAN */
.profile-detail{
  flex:1;
  padding:42px 46px;
  overflow-y:auto;
}
.profile-detail h2{
  margin:0;
  font-size:32px;
  font-weight:700;
}
.profile-detail .jabatan{
  margin-top:6px;
  font-size:18px;
  font-weight:500;
  color:#1e40af;
}

/* DATA LIST */
.detail-list{
  margin-top:30px;
}
.detail-row{
  display:grid;
  grid-template-columns:180px 1fr;
  gap:16px;
  margin-bottom:16px;
  font-size:15px;
}
.detail-row span{
  color:#64748b;
  font-weight:500;
}

/* CLOSE */
.profile-close{
  position:absolute;
  top:18px;
  right:22px;
  font-size:34px;
  color:#fff;
  cursor:pointer;
}

/* ================= RESPONSIVE ================= */
@media(max-width:900px){
  .profile-modal-box{
    flex-direction:column;
    height:auto;
    max-height:95vh;
  }
  .profile-photo-large{
    width:100%;
    height:340px;
  }
  .profile-detail h2{font-size:26px}
  .detail-row{grid-template-columns:140px 1fr}
}
@media(max-width:600px){
  .profile-list{grid-template-columns:1fr}
}
</style>
</head>

<body>

<div class="profile-wrapper">
  <h2 style="text-align:center;margin-bottom:30px;font-weight:700">
    DATA PENGURUS<br>
    <span style="font-size:14px;color:#64748b;font-weight:400">
      DPD PPNI Kabupaten Kutai Kartanegara • Periode 2022–2027
    </span>
  </h2>

  <div id="profiles" class="profile-list"></div>
</div>

<!-- MODAL -->
<div class="profile-modal" id="modal">
  <span class="profile-close" onclick="closeModal()">×</span>

  <div class="profile-modal-box">
    <!-- FOTO -->
    <div class="profile-photo-large">
      <img id="mFoto" alt="">
    </div>

    <!-- DATA -->
    <div class="profile-detail">
      <h2 id="mNama"></h2>
      <div class="jabatan" id="mJabatan"></div>

      <div class="detail-list">
        <div class="detail-row"><span>NIRA</span><div id="mNira"></div></div>
        <div class="detail-row"><span>Komisariat</span><div id="mKomisariat"></div></div>
        <div class="detail-row"><span>Tempat Kerja</span><div id="mKerja"></div></div>
        <div class="detail-row"><span>Tempat Praktik</span><div id="mPraktik"></div></div>
        <div class="detail-row"><span>Nomor STR</span><div id="mSTR"></div></div>
      </div>
    </div>
  </div>
</div>

<script>
/* ================= CONFIG ================= */
const API_URL =
"https://script.google.com/macros/s/AKfycbzaX46LzW37Z2wUeE1DLvffZzN5qq3Nry2Pspk3sRJNVyba-ystVHNCnHF44AYdN-to6w/exec";

/* ================= LOAD DATA ================= */
document.addEventListener("DOMContentLoaded", ()=>{
  fetch(API_URL)
    .then(r=>r.json())
    .then(data=>{
      renderCards(data || []);
      const hash = location.hash.replace("#","");
      if(hash){
        const found = data.find(d=>String(d.ID)===hash);
        if(found) openModal(found);
      }
    })
    .catch(err=>console.error("Load error:", err));
});

/* ================= RENDER CARDS ================= */
function renderCards(data){
  const wrap = document.getElementById("profiles");
  wrap.innerHTML = "";
  data.forEach(d=>{
    const card = document.createElement("div");
    card.className = "profile-card";
    card.innerHTML = `
      <div class="profile-photo">
        <img src="${foto(d.Foto)}" loading="lazy" alt="">
      </div>
      <div class="profile-name">${d.Nama || "-"}</div>
      <div class="profile-role">${d.Jabatan || "-"}</div>
      <div class="profile-nira">NIRA: ${d.NIRA || "-"}</div>
    `;
    card.onclick = ()=>{
      location.hash = d.ID;
      openModal(d);
    };
    wrap.appendChild(card);
  });
}

/* ================= FOTO DRIVE ================= */
function foto(id){
  return id
    ? `https://drive.google.com/thumbnail?id=${id}&sz=w1600`
    : "https://via.placeholder.com/1600";
}

/* ================= MODAL ================= */
function openModal(d){
  const modal = document.getElementById("modal");
  modal.style.display="block";
  mFoto.src = foto(d.Foto);
  mNama.textContent = d.Nama || "-";
  mJabatan.textContent = d.Jabatan || "-";
  mNira.textContent = d.NIRA || "-";
  mKomisariat.textContent = d.Komisariat || "-";
  mKerja.textContent = d["Tempat Kerja"] || "-";
  mPraktik.textContent = d["Tempat Praktik"] || "-";
  mSTR.textContent = d["Nomor STR"] || "-";
}
function closeModal(){
  const modal = document.getElementById("modal");
  modal.style.display="none";
  mFoto.src="";
  history.replaceState(null, document.title, window.location.pathname + window.location.search);
}

/* ESC & CLICK OUT */
document.addEventListener("keydown",e=>{
  if(e.key==="Escape") closeModal();
});
document.getElementById("modal").onclick = e=>{
  if(e.target.id==="modal") closeModal();
};
</script>

</body>
</html>
